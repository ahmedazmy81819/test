<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لعبة الألغاز</title>
    <style>
        /* التصميم العام */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            text-align: center;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            max-width: 500px;
            width: 90%;
            animation: fadeIn 1s ease-in-out;
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            animation: slideIn 1s ease-in-out;
        }
        .hearts {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            color: #ff4757;
            display: flex;
            gap: 10px;
            animation: slideIn 1s ease-in-out;
        }
        .heart {
            transition: all 0.3s ease;
        }
        .heart.lost {
            animation: heartLost 0.5s ease-in-out forwards;
        }
        .question {
            font-size: 1.5rem;
            margin: 20px 0;
            animation: fadeIn 1s ease-in-out;
        }
        .difficulty {
            font-size: 1rem;
            color: #ffdd59;
            margin-bottom: 10px;
        }
        input[type="text"] {
            width: 80%;
            padding: 15px;
            font-size: 1rem;
            margin-bottom: 20px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            transition: all 0.3s ease;
        }
        input[type="text"]:focus {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.05);
        }
        button {
            padding: 15px 30px;
            font-size: 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background: #25d366;
            color: white;
            transition: all 0.3s ease;
            margin: 5px;
        }
        button:hover {
            background: #128C7E;
            transform: scale(1.05);
        }
        button:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
        }
        #hintButton {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #ff9f43;
        }
        #hintButton:hover {
            background: #ff7f00;
        }
        .options {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        .options button {
            width: 100%;
        }
        .lose-screen, .win-screen, .start-screen, .merchant-screen, .dice-screen {
            display: none;
            margin-top: 20px;
            animation: fadeIn 1s ease-in-out;
        }
        .lose-screen h2, .win-screen h2, .start-screen h2, .merchant-screen h2, .dice-screen h2 {
            font-size: 2rem;
            margin-bottom: 20px;
        }
        .score {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        .merchant-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #fff;
        }
        .merchant-item button {
            background: #ff9f43;
        }
        .merchant-item button:hover {
            background: #ff7f00;
        }

        /* تصميم النرد */
        .dice-screen {
            text-align: center;
        }
        .dice-container {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 20px auto;
            perspective: 1000px;
        }
        .dice {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 2s ease-out;
        }
        .dice .face {
            position: absolute;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #333;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            color: #333;
        }
        .dice .face.front { transform: translateZ(50px); }
        .dice .face.back { transform: rotateY(180deg) translateZ(50px); }
        .dice .face.right { transform: rotateY(90deg) translateZ(50px); }
        .dice .face.left { transform: rotateY(-90deg) translateZ(50px); }
        .dice .face.top { transform: rotateX(90deg) translateZ(50px); }
        .dice .face.bottom { transform: rotateX(-90deg) translateZ(50px); }

        .dice-result {
            margin-top: 20px;
            font-size: 1.2rem;
            padding: 10px;
            border-radius: 10px;
            animation: fadeIn 0.5s ease-in-out;
        }
        .dice-result.good {
            background: #4CAF50;
        }
        .dice-result.bad {
            background: #F44336;
        }

        /* قائمة الجوائز */
        .prizes-list {
            margin-top: 20px;
            text-align: left;
        }
        .prizes-list div {
            margin-bottom: 10px;
        }

        /* الرسوم المتحركة */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes heartLost {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- شاشة البداية -->
        <div class="start-screen" id="startScreen">
            <h1>لعبة الألغاز</h1>
            <button onclick="startGame()">ابدأ اللعبة</button>
            <button onclick="showInstructions()">تعليمات</button>
        </div>

        <!-- واجهة اللعبة -->
        <div id="gameScreen" style="display: none;">
            <h1>لعبة الألغاز</h1>
            <div class="hearts" id="hearts">
                <div class="heart">❤️</div>
                <div class="heart">❤️</div>
                <div class="heart">❤️</div>
                <div class="heart">❤️</div>
                <div class="heart">❤️</div>
            </div>
            <button id="hintButton" onclick="showOptions()">عرض الاختيارات (3)</button>
            <button onclick="showMerchant()">التاجر</button>
            <div class="difficulty" id="difficulty"></div>
            <div class="question" id="question"></div>
            <input type="text" id="answer" placeholder="أدخل إجابتك هنا">
            <button id="submitButton" onclick="checkAnswer()" disabled>تحقق</button>
            <button onclick="retryQuestion()">إعادة المحاولة</button>
            <button onclick="goToHome()">العودة للصفحة الرئيسية</button>
            <div class="options" id="options"></div>
            <div class="score" id="score">النقاط: 0</div>
        </div>

        <!-- شاشة الخسارة -->
        <div class="lose-screen" id="loseScreen">
            <h2>عيد يا فالح!</h2>
            <button onclick="restartGame()">إعادة اللعبة</button>
            <button onclick="goToHome()">العودة للصفحة الرئيسية</button>
        </div>

        <!-- شاشة الفوز -->
        <div class="win-screen" id="winScreen">
            <h2>أحسنت! لقد فزت!</h2>
            <button onclick="restartGame()">إعادة اللعبة</button>
            <button onclick="goToHome()">العودة للصفحة الرئيسية</button>
        </div>

        <!-- شاشة التاجر -->
        <div class="merchant-screen" id="merchantScreen">
            <h2>التاجر</h2>
            <div class="merchant-item">
                <span>قلب إضافي (50 نقطة)</span>
                <button onclick="buyHeart()">شراء</button>
            </div>
            <div class="merchant-item">
                <span>زيادة عدد مرات استخدام زر الاختيارات (30 نقطة)</span>
                <button onclick="buyHint()">شراء</button>
            </div>
            <div class="merchant-item">
                <span>حجر النرد (60 نقطة)</span>
                <button onclick="showDice()">رمي النرد</button>
            </div>
            <button onclick="hideMerchant()">العودة للعبة</button>
        </div>

        <!-- شاشة حجر النرد -->
        <div class="dice-screen" id="diceScreen">
            <h2>حجر النرد</h2>
            <div class="dice-container">
                <div class="dice" id="dice">
                    <div class="face front">1</div>
                    <div class="face back">2</div>
                    <div class="face right">3</div>
                    <div class="face left">4</div>
                    <div class="face top">5</div>
                    <div class="face bottom">6</div>
                </div>
            </div>
            <div class="dice-result" id="diceResult"></div>
            <button onclick="rollDice()">رمي النرد</button>
            <button onclick="hideDice()">العودة للتاجر</button>
            <div class="prizes-list">
                <h3>قائمة الجوائز:</h3>
                <div>1: قلبين إضافيين</div>
                <div>2: 60 نقطة</div>
                <div>3: خسارة كل النقاط</div>
                <div>4: لا شيء</div>
                <div>5: 100 نقطة</div>
                <div>6: خسارة قلب واحد</div>
            </div>
        </div>
    </div>

    <script>
        { question: "ما هو الشيء الذي كلما أخذت منه كبر؟", answer: "الحفرة", options: ["الحفرة", "الشجرة", "النار", "الماء"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يملك أسنانًا ولا يعض؟", answer: "المشط", options: ["المشط", "القط", "الكلب", "الأسد"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يسمع بلا أذن ويتكلم بلا لسان؟", answer: "الهاتف", options: ["الهاتف", "الراديو", "التلفزيون", "المذياع"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يدور حول البيت دون أن يتحرك؟", answer: "الجدار", options: ["الجدار", "الباب", "النافذة", "السقف"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يكون أخضر في الأرض وأسود في السوق وأحمر في البيت؟", answer: "الشاي", options: ["الشاي", "القهوة", "العصير", "الحليب"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يكتب ولا يقرأ؟", answer: "القلم", options: ["القلم", "الكتاب", "الدفتر", "الممحاة"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي كلما زاد نقص؟", answer: "العمر", options: ["العمر", "المال", "الصحة", "الوقت"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يحمل طعامه فوق رأسه؟", answer: "القلم", options: ["القلم", "الطبق", "الكوب", "الملعقة"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يدخل مبلولًا ويخرج ناشفًا؟", answer: "الخبز", options: ["الخبز", "الملابس", "الورق", "الفخار"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "سهل" },
            { question: "ما هو الشيء الذي يخترق الزجاج ولا يكسره؟", answer: "الضوء", options: ["الضوء", "الماء", "الهواء", "الصوت"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي له رقبة بلا رأس؟", answer: "الزجاجة", options: ["الزجاجة", "الكوب", "الإبريق", "الكأس"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي يطير بلا أجنحة ويبكي بلا عيون؟", answer: "السحاب", options: ["السحاب", "الطائرة", "الطائر", "الريح"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي ينام مرتديًا حذاءه؟", answer: "الحصان", options: ["الحصان", "الحمار", "البقرة", "الجمل"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي يذهب ولا يعود؟", answer: "الدخان", options: ["الدخان", "الماء", "الهواء", "الضوء"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي يتحرك حولك دائمًا ولا تراه؟", answer: "الهواء", options: ["الهواء", "الضوء", "الصوت", "الظل"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي له مفاتيح ولا يفتح أبوابًا؟", answer: "البيانو", options: ["البيانو", "الكمبيوتر", "السيارة", "الخزانة"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي له أوراق وليس بنبات؟", answer: "الكتاب", options: ["الكتاب", "الشجرة", "الورقة", "الدفتر"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي له بحر بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "البحر", "النهر", "المحيط"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي له مدن بلا منازل، وغابات بلا أشجار، وأنهار بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "الكتاب", "الصورة", "اللوحة"], difficulty: "متوسط" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يعض؟", answer: "المشط", options: ["المشط", "الفرشاة", "المنشار", "المقص"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له رأس وذيل ولا يملك جسمًا؟", answer: "العملة", options: ["العملة", "القلم", "الكتاب", "المفتاح"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أربعة أرجل ولا يمشي؟", answer: "الكرسي", options: ["الكرسي", "الطاولة", "السرير", "الخزانة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له يدان ولا يصفق؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أجنحة ولا يطير؟", answer: "المروحة", options: ["المروحة", "الطائرة", "الطائر", "الفراشة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يأكل؟", answer: "المنشار", options: ["المنشار", "المشط", "الفأس", "السكين"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أوراق وليس بنبات؟", answer: "الكتاب", options: ["الكتاب", "الشجرة", "الورقة", "الدفتر"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له بحر بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "البحر", "النهر", "المحيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له مدن بلا منازل، وغابات بلا أشجار، وأنهار بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "الكتاب", "الصورة", "اللوحة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يعض؟", answer: "المشط", options: ["المشط", "الفرشاة", "المنشار", "المقص"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له رأس وذيل ولا يملك جسمًا؟", answer: "العملة", options: ["العملة", "القلم", "الكتاب", "المفتاح"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أربعة أرجل ولا يمشي؟", answer: "الكرسي", options: ["الكرسي", "الطاولة", "السرير", "الخزانة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له يدان ولا يصفق؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أجنحة ولا يطير؟", answer: "المروحة", options: ["المروحة", "الطائرة", "الطائر", "الفراشة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يأكل؟", answer: "المنشار", options: ["المنشار", "المشط", "الفأس", "السكين"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أوراق وليس بنبات؟", answer: "الكتاب", options: ["الكتاب", "الشجرة", "الورقة", "الدفتر"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له بحر بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "البحر", "النهر", "المحيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له مدن بلا منازل، وغابات بلا أشجار، وأنهار بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "الكتاب", "الصورة", "اللوحة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يعض؟", answer: "المشط", options: ["المشط", "الفرشاة", "المنشار", "المقص"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له رأس وذيل ولا يملك جسمًا؟", answer: "العملة", options: ["العملة", "القلم", "الكتاب", "المفتاح"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أربعة أرجل ولا يمشي؟", answer: "الكرسي", options: ["الكرسي", "الطاولة", "السرير", "الخزانة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له يدان ولا يصفق؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أجنحة ولا يطير؟", answer: "المروحة", options: ["المروحة", "الطائرة", "الطائر", "الفراشة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يأكل؟", answer: "المنشار", options: ["المنشار", "المشط", "الفأس", "السكين"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أوراق وليس بنبات؟", answer: "الكتاب", options: ["الكتاب", "الشجرة", "الورقة", "الدفتر"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له بحر بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "البحر", "النهر", "المحيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له مدن بلا منازل، وغابات بلا أشجار، وأنهار بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "الكتاب", "الصورة", "اللوحة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يعض؟", answer: "المشط", options: ["المشط", "الفرشاة", "المنشار", "المقص"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له رأس وذيل ولا يملك جسمًا؟", answer: "العملة", options: ["العملة", "القلم", "الكتاب", "المفتاح"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أربعة أرجل ولا يمشي؟", answer: "الكرسي", options: ["الكرسي", "الطاولة", "السرير", "الخزانة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له يدان ولا يصفق؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أجنحة ولا يطير؟", answer: "المروحة", options: ["المروحة", "الطائرة", "الطائر", "الفراشة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يأكل؟", answer: "المنشار", options: ["المنشار", "المشط", "الفأس", "السكين"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أوراق وليس بنبات؟", answer: "الكتاب", options: ["الكتاب", "الشجرة", "الورقة", "الدفتر"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له بحر بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "البحر", "النهر", "المحيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له مدن بلا منازل، وغابات بلا أشجار، وأنهار بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "الكتاب", "الصورة", "اللوحة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يعض؟", answer: "المشط", options: ["المشط", "الفرشاة", "المنشار", "المقص"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له رأس وذيل ولا يملك جسمًا؟", answer: "العملة", options: ["العملة", "القلم", "الكتاب", "المفتاح"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أربعة أرجل ولا يمشي؟", answer: "الكرسي", options: ["الكرسي", "الطاولة", "السرير", "الخزانة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له يدان ولا يصفق؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أجنحة ولا يطير؟", answer: "المروحة", options: ["المروحة", "الطائرة", "الطائر", "الفراشة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يأكل؟", answer: "المنشار", options: ["المنشار", "المشط", "الفأس", "السكين"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أوراق وليس بنبات؟", answer: "الكتاب", options: ["الكتاب", "الشجرة", "الورقة", "الدفتر"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له بحر بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "البحر", "النهر", "المحيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له مدن بلا منازل، وغابات بلا أشجار، وأنهار بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "الكتاب", "الصورة", "اللوحة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يعض؟", answer: "المشط", options: ["المشط", "الفرشاة", "المنشار", "المقص"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له رأس وذيل ولا يملك جسمًا؟", answer: "العملة", options: ["العملة", "القلم", "الكتاب", "المفتاح"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أربعة أرجل ولا يمشي؟", answer: "الكرسي", options: ["الكرسي", "الطاولة", "السرير", "الخزانة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له يدان ولا يصفق؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أجنحة ولا يطير؟", answer: "المروحة", options: ["المروحة", "الطائرة", "الطائر", "الفراشة"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أسنان ولا يأكل؟", answer: "المنشار", options: ["المنشار", "المشط", "الفأس", "السكين"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له عين واحدة ولا يرى؟", answer: "الإبرة", options: ["الإبرة", "الدبوس", "المسمار", "الخيط"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له وجه ويدان ولا يملك قدمين؟", answer: "الساعة", options: ["الساعة", "التلفزيون", "الراديو", "الهاتف"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له أوراق وليس بنبات؟", answer: "الكتاب", options: ["الكتاب", "الشجرة", "الورقة", "الدفتر"], difficulty: "صعب" },
            { question: "ما هو الشيء الذي له بحر بلا ماء؟", answer: "الخريطة", options: ["الخريطة", "البحر", "النهر", "المحيط"], difficulty: "صعب" },
        ];

        let currentQuestionIndex = 0;
        let hearts = 5;
        let hintCount = 3;
        let score = 0;
        const heartsElement = document.getElementById('hearts');
        const questionElement = document.getElementById('question');
        const difficultyElement = document.getElementById('difficulty');
        const answerInput = document.getElementById('answer');
        const submitButton = document.getElementById('submitButton');
        const hintButton = document.getElementById('hintButton');
        const optionsElement = document.getElementById('options');
        const loseScreen = document.getElementById('loseScreen');
        const winScreen = document.getElementById('winScreen');
        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const merchantScreen = document.getElementById('merchantScreen');
        const diceScreen = document.getElementById('diceScreen');
        const diceElement = document.getElementById('dice');
        const diceResultElement = document.getElementById('diceResult');
        const scoreElement = document.getElementById('score');

        // قائمة الجوائز
        const prizes = [
            { type: "heart", value: 2, message: "لقد ربحت قلبين إضافيين!", color: "good" },
            { type: "points", value: 60, message: "لقد ربحت 60 نقطة!", color: "good" },
            { type: "losePoints", value: 0, message: "لقد خسرت كل النقاط!", color: "bad" },
            { type: "nothing", value: 0, message: "لم تربح أي شيء!", color: "bad" },
            { type: "points", value: 100, message: "لقد ربحت 100 نقطة!", color: "good" },
            { type: "loseHeart", value: 1, message: "لقد خسرت قلبًا واحدًا!", color: "bad" }
        ];

        // دالة لحساب المسافة بين الكلمتين (Levenshtein Distance)
        function levenshteinDistance(a, b) {
            const matrix = [];
            for (let i = 0; i <= b.length; i++) {
                matrix[i] = [i];
            }
            for (let j = 0; j <= a.length; j++) {
                matrix[0][j] = j;
            }
            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    if (b.charAt(i - 1) === a.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1, // استبدال
                            matrix[i][j - 1] + 1,    // إضافة
                            matrix[i - 1][j] + 1     // حذف
                        );
                    }
                }
            }
            return matrix[b.length][a.length];
        }

        // تحميل التقدم المحفوظ
        function loadProgress() {
            const savedProgress = JSON.parse(localStorage.getItem('gameProgress'));
            if (savedProgress) {
                currentQuestionIndex = savedProgress.currentQuestionIndex;
                hearts = savedProgress.hearts;
                hintCount = savedProgress.hintCount;
                score = savedProgress.score;
                updateHearts();
                scoreElement.textContent = `النقاط: ${score}`;
                hintButton.textContent = `عرض الاختيارات (${hintCount})`;
                if (hintCount === 0) {
                    hintButton.disabled = true;
                }
                loadQuestion();
            }
        }

        // حفظ التقدم
        function saveProgress() {
            const progress = {
                currentQuestionIndex,
                hearts,
                hintCount,
                score
            };
            localStorage.setItem('gameProgress', JSON.stringify(progress));
        }

        // تحديث القلوب مع تأثيرات
        function updateHearts() {
            const heartElements = heartsElement.querySelectorAll('.heart');
            heartElements.forEach((heart, index) => {
                if (index >= hearts) {
                    heart.classList.add('lost');
                } else {
                    heart.classList.remove('lost');
                }
            });
            if (hearts === 0) {
                loseScreen.style.display = 'block';
                gameScreen.style.display = 'none';
                resetGame(); // إعادة تعيين اللعبة عند فقدان جميع القلوب
            }
        }

        // إعادة تعيين اللعبة
        function resetGame() {
            currentQuestionIndex = 0;
            hearts = 5;
            hintCount = 3;
            score = 0;
            localStorage.removeItem('gameProgress'); // حذف التقدم المحفوظ
            updateHearts();
            scoreElement.textContent = `النقاط: ${score}`;
            hintButton.textContent = `عرض الاختيارات (${hintCount})`;
            hintButton.disabled = false;
            loadQuestion();
        }

        // تحميل السؤال الحالي
        function loadQuestion() {
            const currentQuestion = questions[currentQuestionIndex];
            questionElement.textContent = currentQuestion.question;
            difficultyElement.textContent = `صعوبة الفزورة: ${currentQuestion.difficulty}`;
            answerInput.value = '';
            optionsElement.style.display = 'none'; // إخفاء الخيارات عند تحميل سؤال جديد
        }

        // جعل الكود غير حساس للحروف المتشابهة
        function normalizeArabicText(text) {
            return text
                .replace(/[أإآ]/g, 'ا')
                .replace(/[ى]/g, 'ي')
                .replace(/[ة]/g, 'ه')
                .replace(/[ؤ]/g, 'و')
                .replace(/\s+/g, ' ') // إزالة المسافات الزائدة
                .trim(); // إزالة المسافات من البداية والنهاية
        }

        // التحقق من الإجابة
        function checkAnswer() {
            const userAnswer = normalizeArabicText(answerInput.value.trim().toLowerCase());
            const correctAnswer = normalizeArabicText(questions[currentQuestionIndex].answer.toLowerCase());

            if (userAnswer === correctAnswer) {
                alert("إجابة صحيحة!");
                score += 10;
                scoreElement.textContent = `النقاط: ${score}`;
                nextQuestion();
            } else {
                const distance = levenshteinDistance(userAnswer, correctAnswer);
                if (distance <= 2) { // إذا كانت المسافة بين الكلمتين 2 أو أقل
                    alert("قربت من الإجابة الصحيحة!");
                } else {
                    hearts--;
                    updateHearts();
                    alert("إجابة خاطئة!");
                }
            }
            saveProgress();
        }

        // الانتقال للسؤال التالي
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex >= questions.length) {
                winScreen.style.display = 'block';
                gameScreen.style.display = 'none';
            } else {
                loadQuestion();
            }
            saveProgress();
        }

        // عرض الاختيارات كأزرار
        function showOptions() {
            if (hintCount > 0) {
                const currentQuestion = questions[currentQuestionIndex];
                const shuffledOptions = shuffleArray([...currentQuestion.options]);
                optionsElement.innerHTML = '';
                shuffledOptions.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.onclick = () => {
                        const normalizedOption = normalizeArabicText(option.toLowerCase());
                        const correctAnswer = normalizeArabicText(currentQuestion.answer.toLowerCase());
                        if (normalizedOption === correctAnswer) {
                            alert("إجابة صحيحة!");
                            score += 10;
                            scoreElement.textContent = `النقاط: ${score}`;
                            nextQuestion();
                        } else {
                            hearts--;
                            updateHearts();
                            alert("إجابة خاطئة!");
                        }
                        optionsElement.style.display = 'none';
                    };
                    optionsElement.appendChild(button);
                });
                optionsElement.style.display = 'flex';
                hintCount--;
                hintButton.textContent = `عرض الاختيارات (${hintCount})`;
                if (hintCount === 0) {
                    hintButton.disabled = true;
                }
                saveProgress();
            }
        }

        // إعادة المحاولة
        function retryQuestion() {
            answerInput.value = '';
            optionsElement.style.display = 'none';
        }

        // العودة للصفحة الرئيسية
        function goToHome() {
            startScreen.style.display = 'block';
            gameScreen.style.display = 'none';
            loseScreen.style.display = 'none';
            winScreen.style.display = 'none';
        }

        // بدء اللعبة
        function startGame() {
            currentQuestionIndex = 0;
            hearts = 5;
            hintCount = 3;
            score = 0;
            startScreen.style.display = 'none';
            gameScreen.style.display = 'block';
            loadRandomQuestion();
            updateHearts();
            scoreElement.textContent = `النقاط: ${score}`;
        }

        // تحميل سؤال عشوائي
        function loadRandomQuestion() {
            currentQuestionIndex = Math.floor(Math.random() * questions.length);
            loadQuestion();
        }

        // إعادة اللعبة
        function restartGame() {
            loseScreen.style.display = 'none';
            winScreen.style.display = 'none';
            startGame();
        }

        // عرض التعليمات
        function showInstructions() {
            alert("تعليمات اللعبة:\n1. اقرأ السؤال وأدخل الإجابة.\n2. لديك 5 قلوب، تفقد واحدًا عند الإجابة الخاطئة.\n3. يمكنك استخدام زر الاختيارات 3 مرات فقط.\n4. حاول تحقيق أعلى النقاط!");
        }

        // ترتيب عشوائي للمصفوفة
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // عرض شاشة التاجر
        function showMerchant() {
            gameScreen.style.display = 'none';
            merchantScreen.style.display = 'block';
        }

        // إخفاء شاشة التاجر
        function hideMerchant() {
            merchantScreen.style.display = 'none';
            gameScreen.style.display = 'block';
        }

        // شراء قلب إضافي
        function buyHeart() {
            if (score >= 50) {
                hearts++;
                score -= 50;
                scoreElement.textContent = `النقاط: ${score}`;
                updateHearts();
                alert("لقد اشتريت قلبًا إضافيًا!");
                saveProgress();
            } else {
                alert("ليس لديك نقاط كافية!");
            }
        }

        // شراء زيادة عدد مرات استخدام زر الاختيارات
        function buyHint() {
            if (score >= 30) {
                hintCount++;
                score -= 30;
                scoreElement.textContent = `النقاط: ${score}`;
                hintButton.textContent = `عرض الاختيارات (${hintCount})`;
                hintButton.disabled = false;
                alert("لقد اشتريت زيادة في عدد مرات استخدام زر الاختيارات!");
                saveProgress();
            } else {
                alert("ليس لديك نقاط كافية!");
            }
        }

        // عرض شاشة حجر النرد
        function showDice() {
            if (score >= 60) {
                merchantScreen.style.display = 'none';
                diceScreen.style.display = 'block';
            } else {
                alert("ليس لديك نقاط كافية!");
            }
        }

        // إخفاء شاشة حجر النرد
        function hideDice() {
            diceScreen.style.display = 'none';
            merchantScreen.style.display = 'block';
        }

        // رمي النرد
        function rollDice() {
            if (score < 60) {
                alert("ليس لديك نقاط كافية!");
                return;
            }

            // خصم 60 نقطة
            score -= 60;
            scoreElement.textContent = `النقاط: ${score}`;

            // تدوير النرد
            const dice = document.getElementById('dice');
            const randomRotationX = Math.floor(Math.random() * 360);
            const randomRotationY = Math.floor(Math.random() * 360);
            const randomRotationZ = Math.floor(Math.random() * 360);
            dice.style.transform = `rotateX(${randomRotationX}deg) rotateY(${randomRotationY}deg) rotateZ(${randomRotationZ}deg)`;

            // تحديد الوجه الظاهر
            setTimeout(() => {
                const visibleFace = determineVisibleFace(randomRotationX, randomRotationY, randomRotationZ);
                const prize = prizes[visibleFace - 1]; // لأن الأرقام من 1 إلى 6

                // تطبيق الجائزة
                switch (prize.type) {
                    case "heart":
                        hearts += prize.value;
                        updateHearts();
                        break;
                    case "points":
                        score += prize.value;
                        scoreElement.textContent = `النقاط: ${score}`;
                        break;
                    case "losePoints":
                        score = 0;
                        scoreElement.textContent = `النقاط: ${score}`;
                        break;
                    case "loseHeart":
                        hearts -= prize.value;
                        updateHearts();
                        break;
                    default:
                        break;
                }

                // عرض نتيجة الجائزة
                diceResultElement.textContent = prize.message;
                diceResultElement.className = `dice-result ${prize.color}`;
                saveProgress();
            }, 2000); // تأخير عرض النتيجة بعد انتهاء الدوران
        }

        // تحديد الوجه الظاهر
        function determineVisibleFace(rotationX, rotationY, rotationZ) {
            // تحويل الزوايا إلى نطاق 0-360
            rotationX = rotationX % 360;
            rotationY = rotationY % 360;
            rotationZ = rotationZ % 360;

            // تحديد الوجه الظاهر بناءً على الزوايا
            if (rotationX < 45 || rotationX >= 315) return 1; // الوجه الأمامي
            if (rotationX >= 45 && rotationX < 135) return 5; // الوجه العلوي
            if (rotationX >= 135 && rotationX < 225) return 2; // الوجه الخلفي
            if (rotationX >= 225 && rotationX < 315) return 6; // الوجه السفلي
            if (rotationY >= 45 && rotationY < 135) return 3; // الوجه الأيمن
            if (rotationY >= 135 && rotationY < 225) return 4; // الوجه الأيسر
            return 1; // افتراضيًا الوجه الأمامي
        }

        // تحميل التقدم عند بدء اللعبة
        loadProgress();
        startScreen.style.display = 'block';

        // تعطيل زر "تحقق" إذا كان حقل الإجابة فارغًا
        answerInput.addEventListener('input', () => {
            submitButton.disabled = answerInput.value.trim() === '';
        });
    </script>
</body>
</html>
